---
title: "CO2SYS"
author: "Jose Martinez"
date: "2023-03-23"
output: html_document
---

```{r}
###############
# Can we quantify ocean acidification in the subtropical North Atlantic Ocean?
#1) Is surface ocean pCo2 increasing?
#2) is surface ocean seawater pH decreasing?
#3) Is surface ocean seawater saturation state with respect to aragonite decreasing?

# Intro > Methods > Results > Discussion mini-lab report 
###############
```

### Load required libraries

```{r setup, include=FALSE}
library(prettydoc)
library(tidyverse)
library(seacarb)
library(gsw)
library(readr)
library(plotly)

```




```{r}
library(readr)

bats_bottle <- read_delim("bats_bottle.txt", 
    delim = "\t", escape_double = FALSE, 
    col_names = FALSE, trim_ws = TRUE, skip = 60)
# import column names from BATS and assign to Data
colnames(bats_bottle) = colnames(read_csv("bats_bottle.txt", 
    skip = 59))
View(bats_bottle)

```
## Variable Names

yyyymmdd = Year Month Day   
decy   = Decimal Year     
time   = Time (hhmm)      
latN   = Latitude (Deg N) 
lonW   = Longitude (Deg W)
Depth  = Depth (m)                  
Temp   = Temperature ITS-90 (C)    
CTD_S  = CTD Salinity (PSS-78)      
Sal1   = Salinity-1 (PSS-78)        
Sig-th = Sigma-Theta (kg/m^3)       
O2(1)  = Oxygen-1 (umol/kg)          
OxFixT = Oxygen Fix Temp (C)        
Anom1  = Oxy Anomaly-1 (umol/kg)    
CO2    = dissolved inorganic carbon (umol/kg)              
Alk    = Alkalinity (uequiv)        
NO31   = Nitrate+Nitrite-1 (umol/kg)
NO21   = Nitrite-1 (umol/kg)        
PO41   = Phosphate-1 (umol/kg)      
Si1    = Silicate-1 (umol/kg)       
POC    = POC (ug/kg)                
PON    = PON (ug/kg)                
TOC    = TOC (umol/kg)                
TN     = TN (umol/kg)  
Bact   = Bacteria enumeration (cells*10^8/kg)   
POP    = POP (umol/kg)
TDP    = Total dissolved Phosphorus (nmol/kg)
SRP    = Low-level phosphorus (nmol/kg)
BSi    = Particulate biogenic silica (umol/kg)
LSi    = Particulate lithogenic silica  (umol/kg)
Pro    = Prochlorococcus (cells/ml)
Syn    = Synechococcus (cells/ml)
Piceu  = Picoeukaryotes (cells/ml)
Naneu  = Nanoeukaryotes (cells/ml)

Quality flags
-999 = Missing or bad data
   0 = Less than detection limit

```{r}
# Calculate CO2SYS parameters
#carb(flag, var1, var2, S=35, T=25, Patm=1, P=0, Pt=0, Sit=0,
 #       k1k2="x", kf="x", ks="d", pHscale="T", b="u74", gas="potential", 
  #      warn="y", eos="eos80", long=1.e20, lat=1.e20)
#we have TA and DI, S, T, Pt, Sit, but no pressure
bats_co2 = bats_bottle %>% 
  mutate(P_gsw = gsw_p_from_z(Depth*-1,latN))
# now we have all the necessary variables to calculate the surface seawater chemistry parameters but be careful with our units

# We now have TA, DIC, S, T, Pt, Sit, and Pressure
# what are the units of these and what does CO2SYS need?

#DIC umol/kg we need mol/kg
#TA is in uequiv, which is essentially (umol/kg) we need mol/kg
#S is in PSS and we will EOS80 (PSS)
#T is in degrees C and we need degrees
#Sit is in umol/kg, we need mol/kg
#Pt is in umol/kg we need mol/kg
#P_dbar is in dbar and we need bar

# We will need to converrt units scaling with CO2SYS

```


